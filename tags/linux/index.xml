<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Linux on MLAcookie</title><link>https://mlacookie.github.io/tags/linux/</link><description>Recent content in Linux on MLAcookie</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Thu, 22 Aug 2024 22:04:25 +0800</lastBuildDate><atom:link href="https://mlacookie.github.io/tags/linux/index.xml" rel="self" type="application/rss+xml"/><item><title>配置Windows+Manjaro双系统</title><link>https://mlacookie.github.io/article/posts/%E9%85%8D%E7%BD%AEwindows+manjaro%E5%8F%8C%E7%B3%BB%E7%BB%9F/</link><pubDate>Thu, 22 Aug 2024 22:04:25 +0800</pubDate><guid>https://mlacookie.github.io/article/posts/%E9%85%8D%E7%BD%AEwindows+manjaro%E5%8F%8C%E7%B3%BB%E7%BB%9F/</guid><description>&lt;p>emmmm&lt;br>
之前在笔记本上安装了Manjaro&lt;br>
基本上所有需要的软件都有了解决方案&lt;br>
甚至打游戏都不是很大的问题&lt;br>
结果没想到败在了游戏加速器上&lt;br>
Linux没有现成的游戏加速器，而且我不会配网卡类型的代理&lt;br>
（就算配起来我也没有游戏优化的代理服务器）&lt;/p>
&lt;p>所以没办法，又要用Windows了&lt;br>
不过我又不想放弃Linux的轻量精简&lt;br>
于是我就给笔记本做了个双系统&lt;/p>
&lt;p>（因为在物理机上安装，所以目前没什么图，有机会再补吧）&lt;/p>
&lt;h2 id="0x00-前置准备">&amp;lt;0x00&amp;gt; 前置准备
&lt;/h2>&lt;p>首先需要一个U盘，做系统安装盘&lt;br>
这次仍然使用Ventoy做系统引导&lt;br>
Ventoy的使用就不说了，基本上就是软件打开选择U盘安装即可 &lt;br>
然后需要准备需要的Windows镜像和Manjaro镜像&lt;br>
还需要一个WinPE的镜像，我的建议是用微PE工具生成一个&lt;br>
我们需要使用这个PE来提前给硬盘分区&lt;/p>
&lt;h2 id="0x01-pe中的操作">&amp;lt;0x01&amp;gt; PE中的操作
&lt;/h2>&lt;p>PE中，我们主要是给系统进行分盘&lt;br>
如果你会在Windows安装器中分盘的话可以跳过&lt;/p>
&lt;p>Ventoy引导进PE的iso&lt;br>
一般PE中会带一个分区工具，有啥用啥，我使用的是DG&lt;br>
里面有个快速分区工具，使用这个分两个盘，大小随意&lt;br>
分出来都是NTFS格式的，删除希望安装Manjaro的分区，等之后用Manjaro安装工具分区&lt;br>
分好区后，保存更改，就可以退出PE系统了&lt;/p>
&lt;h3 id="为什么要提前分盘">为什么要提前分盘
&lt;/h3>&lt;p>现在我们安装系统都是将硬盘做成GPT分区格式&lt;br>
里面有一个EFI分区，里面会放系统的引导&lt;br>
如果用Windows安装器在没有任何分区的硬盘上安装&lt;br>
它会自动创建一个100MB的EFI分区&lt;br>
但对Linux来说，这100MB的EFI分区太小了，Linux建议大于300MB&lt;br>
而DG的快速分区可以在分出两个大小的分区的同时，自动创建300MB的EFI分区&lt;br>
正好满足我们的需求&lt;/p>
&lt;h2 id="0x02-安装windows">&amp;lt;0x02&amp;gt; 安装Windows
&lt;/h2>&lt;p>Ventoy引导进Windows的iso&lt;br>
Windows安装在之前分的你希望的位置&lt;br>
基本上就按照安装器指引即可&lt;/p>
&lt;h2 id="0x03-安装manjaro">&amp;lt;0x03&amp;gt; 安装Manjaro
&lt;/h2>&lt;p>Ventoy引导进Manjaro的iso&lt;br>
在安装中，需要选择最下面的手动分区&lt;br>
对于300MB的EFI分区，我们需要编辑，设置挂载点为&lt;code>/boot/efi&lt;/code>，下面的标记别动&lt;br>
这个很关键，将影响我们能否引导进系统&lt;br>
对于希望安装Manjaro的位置，首先新建分区，我选择的是&lt;code>ext4&lt;/code>&lt;br>
然后编辑分区，设置挂载点为&lt;code>/&lt;/code>，选择标记为&lt;code>boot&lt;/code> &lt;br>
剩下的挂载点我看别人是有配置的，不过这样配置两个挂载点就够了&lt;br>
剩下就让安装器折腾就可以了&lt;/p>
&lt;p>安装后进入&lt;code>BIOS&lt;/code>，设置硬盘的启动项，这时候里面会有一个Manjaro的选项&lt;br>
（注意不是启动项，是硬盘的启动项，管理一个硬盘里面的启动项）&lt;/p>
&lt;p>这样之后，理论上启动后默认进入Manjaro的grub界面&lt;/p></description></item><item><title>机革本本装Linux</title><link>https://mlacookie.github.io/article/posts/%E6%9C%BA%E9%9D%A9%E6%9C%AC%E6%9C%AC%E8%A3%85linux/</link><pubDate>Sun, 28 Jul 2024 12:47:37 +0800</pubDate><guid>https://mlacookie.github.io/article/posts/%E6%9C%BA%E9%9D%A9%E6%9C%AC%E6%9C%AC%E8%A3%85linux/</guid><description>&lt;p>暑假经典节目，与Linux大战300回合&lt;/p>
&lt;p>这次我打算好好配置下Linux并作为日常使用&lt;br>
发行版的话我使用Manjaro，因为比Arch好配置，也有AUR的便捷&lt;br>
笔记本是无界14+，并且更新过BIOS&lt;br>
（建议更新下BIOS，可以调整核显内存分配，不然Linux里面核显只能调512M显存）&lt;/p>
&lt;p>因为是在笔记本上装，就没啥截图了&lt;/p>
&lt;h2 id="0x00-安装准备">&amp;lt;0x00&amp;gt; 安装准备
&lt;/h2>&lt;p>简单来说，找个U盘，用Ventoy做启动盘，然后把Manjaro的ISO放进去就可以&lt;/p>
&lt;h3 id="选择你的桌面环境">选择你的桌面环境
&lt;/h3>&lt;p>&lt;a class="link" href="https://manjaro.org/products/download/x86" target="_blank" rel="noopener"
>ManjaroISO&lt;/a>&lt;br>
选哪个桌面环境呢，我最后选择了KDE的版本&lt;br>
经过更新后，KDE的设计总算跟上时代了，颜值不错&lt;br>
并且KDE环境可设置选项也挺多的，自带很多实用小工具&lt;/p>
&lt;p>其他的不是说不好，但确实不合适&lt;br>
Gnome一些习惯我适应不了，xfce不是很适合高分屏，其他的没试过&lt;/p>
&lt;h3 id="用ventoy做引导">用Ventoy做引导
&lt;/h3>&lt;p>Ventoy可以直接引导ISO启动，然后通过ISO本身装系统&lt;br>
加上ISO格式的PE，完全可以当成PE用，并且装系统也很方便&lt;/p>
&lt;p>如果有装Scoop或Winget，直接敲命令安装&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Scoop&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>scoop install ventoy
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Winget&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>winget install Ventoy.Ventoy
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>没有的话就自己下载吧&lt;br>
&lt;a class="link" href="https://www.ventoy.net/en/download.html" target="_blank" rel="noopener"
>Ventoy下载&lt;/a>&lt;/p>
&lt;p>下载完后，找个U盘，打开Ventoy，安装即可&lt;br>
安装好后，把下载好的ISO拖进U盘就可以&lt;/p>
&lt;h2 id="0x01-安装manjaro">&amp;lt;0x01&amp;gt; 安装Manjaro
&lt;/h2>&lt;p>U盘插上笔记本，开机，狂按那几个进BIOS的键&lt;br>
（&lt;code>ESC&lt;/code>，&lt;code>F1&lt;/code>，&lt;code>F2&lt;/code>，&lt;code>F3&lt;/code>，&lt;code>F10&lt;/code>，&lt;code>F11&lt;/code>，&lt;code>F12&lt;/code>，&lt;code>DEL&lt;/code>）&lt;br>
进BIOS后，选择U盘启动&lt;br>
会进入Ventoy的引导界面，选择之前导入的ISO&lt;/p>
&lt;p>然后系统会从ISO启动，进入Manjaro的启动界面&lt;br>
这里它默认会使用开源驱动启动（&lt;code>Boot with open source drivers&lt;/code>）&lt;br>
我建议是按&lt;code>↓&lt;/code>方向键，选择使用专有驱动启动（&lt;code>Boot with proprietary drivers&lt;/code>）&lt;br>
这样的话之后安装的也是专有驱动，遇到的驱动问题会少点&lt;/p>
&lt;p>Manjaro安装环境正式启动后，你可以先试试看这个系统&lt;br>
如果发现系统元素很小，而且调整系统缩放会导致比例很奇怪&lt;br>
这个没什么办法，因为安装环境下使用的窗口服务是X11，对高分辨率支持不是很好&lt;br>
不过安装后就可以用新的Wayland启动了，这个对高分辨率支持不错的&lt;/p>
&lt;p>确定要安装后，就可以双击安装器进行安装，这个跟着安装器指引就可以&lt;br>
安装完重启，就可以进入Manjaro系统了&lt;/p>
&lt;h2 id="0x02-安装完要干的事">&amp;lt;0x02&amp;gt; 安装完要干的事
&lt;/h2>&lt;h3 id="配置速度快的源">配置速度快的源
&lt;/h3>&lt;p>Manjaro内置自动配置快速软件源的工具&lt;br>
打开终端&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>sudo pacman-mirrors -g
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>执行即可，就是因为要把世界上所有源都试一遍，所以等待时间会有点久&lt;/p>
&lt;h3 id="更新所有的包">更新所有的包
&lt;/h3>&lt;p>可以通过&lt;code>升级/删除软件包&lt;/code>用图形化界面更新所有的包&lt;br>
也可以敲命令&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>sudo pacman -Syyu
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>顺便也可以看看前面配置的源的速度&lt;/p>
&lt;h3 id="安装yay">安装yay
&lt;/h3>&lt;p>yay是AUR的管理器，需要注意的是，AUR并非Arch官方维护，需要自己甄别软件的安全性&lt;br>
不过也正是这样，通过AUR可以非常轻松地获取其他软件&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>sudo pacman -S yay base-devel
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>因为AUR的软件需要从源码编译，需要安装&lt;code>base-devel&lt;/code>提供一些基础的工具链&lt;/p>
&lt;p>yay在安装软件时，会优先检索pacman中的内容，并且语法上跟pacman是一致的&lt;br>
所以之后软件的安装/升级/删除都可以交给yay&lt;br>
需要注意的是yay安装软件时不需要sudo，在需要权限提升时，它会要求输入密码的&lt;/p>
&lt;p>然后安装软件的时候，如果后缀有带bin的，一般说明是二进制版本，优先选择这个&lt;br>
这样的话就不用从源代码编译了，安装会快很多&lt;/p>
&lt;h3 id="配置fcitx5">配置fcitx5
&lt;/h3>&lt;p>&lt;code>fcitx5&lt;/code>是一个输入法框架，装上后再配置下就可以输入中文了&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>sudo pacman -S fcitx5 fcitx5-configtool fcitx5-breeze fcitx5-chinese-addons fcitx5-gtk fcitx5-qt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>安装好后，在系统设置内会多一个&lt;code>输入法&lt;/code>的页面，先启动下输入法&lt;br>
然后在&lt;code>系统设置&amp;gt;&amp;gt;键盘&amp;gt;&amp;gt;虚拟键盘&lt;/code>中选择&lt;code>fcitx5&lt;/code>即可&lt;br>
再在&lt;code>输入法&amp;gt;&amp;gt;配置附加组件&lt;/code>中稍微配置配置些主题之类的就可以了&lt;/p>
&lt;h4 id="为非wayland应用配置输入法">为非Wayland应用配置输入法
&lt;/h4>&lt;p>目前的配置只能在使用Wayland的窗口中使用输入法&lt;br>
而Linux中仍有许多软件是跑在X11上的&lt;br>
对于这些软件我们需要通过环境变量让它们识别输入法&lt;br>
我这里是把环境变量写到&lt;code>/etc/profile&lt;/code>的方式实现&lt;/p>
&lt;p>Manjaro的&lt;code>/etc/profile&lt;/code>实际上是遍历运行&lt;code>/etc/profile.d&lt;/code>文件夹的内容&lt;br>
所以最好是在&lt;code>/etc/profile.d&lt;/code>中新建文件，在里面写上环境变量&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>cd /etc/profile.d
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nano set-fcitx5.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>在文件中输入&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>export XMODIFIERS&lt;span style="color:#f92672">=&lt;/span>@im&lt;span style="color:#f92672">=&lt;/span>fcitx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>保存退出后，重启系统，这块就配置好了&lt;br>
现在对于大部分运行在x11中的应用是处理完了&lt;br>
但对于部分软件，可能仍无法使用输入法，这就需要对软件单独配置环境变量&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 如果软件使用QT框架&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>QT_IM_MODULE&lt;span style="color:#f92672">=&lt;/span>fcitx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 如果软件使用GTK框架&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GTK_IM_MODULE&lt;span style="color:#f92672">=&lt;/span>fcitx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>这两句虽然是可以直接塞在前面的配置文件中当全局变量，但官方不推荐&lt;/p>
&lt;h2 id="0x03-安装其他的软件">&amp;lt;0x03&amp;gt; 安装其他的软件
&lt;/h2>&lt;h3 id="vs-code">VS Code
&lt;/h3>&lt;p>经常用的开发环境&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>yay visual-studio-code-bin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>安装完修改启动参数来启用wayland&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>--enable-features&lt;span style="color:#f92672">=&lt;/span>UseOzonePlatform
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>--ozone-platform&lt;span style="color:#f92672">=&lt;/span>wayland
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>--enable-wayland-ime
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="edge">Edge
&lt;/h3>&lt;p>目前我的大部分浏览器数据在Edge上&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>yay microsoft-edge-stable-bin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>安装完修改启动参数来启用wayland，参数跟上面的&lt;code>VS Code&lt;/code>一样&lt;/p>
&lt;h3 id="hiddify">hiddify
&lt;/h3>&lt;p>魔法学，不细讲&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>yay hiddify-next-bin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="0x04-其他实用命令">&amp;lt;0x04&amp;gt; 其他实用命令
&lt;/h2>&lt;h3 id="删除不需要的依赖">删除不需要的依赖
&lt;/h3>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>yay -Rns &lt;span style="color:#66d9ef">$(&lt;/span>yay -Qdt&lt;span style="color:#66d9ef">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="查看窗口运行服务">查看窗口运行服务
&lt;/h3>&lt;p>对于高分屏，wayland的支持是好得多的&lt;br>
即使KDE跑x11应用时，由于允许应用自行缩放，所以大部分情况下还是清晰的&lt;br>
但跑在wayland下可以杜绝大部分控件缩放问题&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># qdbus可能不存在，改为qdbus6&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>qdbus org.kde.KWin /KWin org.kde.KWin.showDebugConsole
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>运行后会跳出一个小工具，用来查看所有窗口运行在哪个服务上&lt;/p>
&lt;h2 id="0x05-遇到的奇怪闪屏问题">&amp;lt;0x05&amp;gt; 遇到的奇怪闪屏问题
&lt;/h2>&lt;p>不知道为什么，我安装完系统后发现系统总会有奇怪的闪屏&lt;br>
换了其他桌面系统后多少都会有点&lt;/p>
&lt;p>在折腾了很多包之后，我大概定位到是AMD的2D驱动问题&lt;br>
AMD的显卡驱动很散，OpenGL驱动和Vulkan驱动都是分开装的&lt;br>
Manjaro默认不会装Xorg的2D加速驱动，这可能是导致奇怪闪屏的原因&lt;/p>
&lt;p>安装的话很简单&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>yay -S xf86-video-amdgpu
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>安装上之后，闪屏遇到的少了，但不能根除&lt;/p>
&lt;p>不排除Vulkan驱动的问题，AMDGPU的节能选项的问题&lt;/p></description></item></channel></rss>